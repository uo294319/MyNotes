# Peer-to-Peer (P2P) Protocol
---
[Go Back](UNIOVI/3S2_DistSys/README.md)

---
## Distributed Hash Table (DHT)
- Is a key-value data structure (Also called Map or dictionary) stored in a distributed manner.
### Overlay Network Creation
1. Each node has a Global Unique Identifier (GUI) that is 160 bit to avoid collisions.
	1. Random GUI.
	2. GUI generated from hashing two items such as generation time and MAC address.
2. We arrange the nodes in a circle ordered by its GUI.
	1. Some of the nodes could be inactive resulting in gaps.
	2. We assume we can calculate next active node.
3. Each node stores some key-value pairs of the DHT.
	1. Each node will store the key-value pairs whose hashed key matches its GUI.
	2. As some nodes are inactive, active nodes store the pairs of the inactive ones behind them.
4. Finger list.
	1. If there are $2^n$ nodes, each node will know (the IPs of) $n$ other nodes.
	2. Usually, a fixed rule that is to store the nodes at a distance $2^i$ with $i = 1, 2, 3 ...$
		1. Chord. Distance = $MOD(B-A+2^n, 2^n$) (number of nodes)
		2. Kademlia. Distance = $A$ XOR $B$
5. Searches.
	1. The node with the highest GUI below the searched node GUI will be asked.
	2. Iterate until a node that knows the searched GUI is found.
6. Connections to the network.
	1. First node is known as the boot node.
	2. Whenever a node connects finger list of all nodes gets updated.
	3. Node's finger list will have replaced inactive nodes GUI by the next node of the inactive one.